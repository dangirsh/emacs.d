# Modes config file

* Org mode

** Set org files root
#+begin_src emacs-lisp
(setq org-files-root (format "%sorg/" user-emacs-directory))
(unless (file-accessible-directory-p org-files-root)
  (make-directory org-files-root))
#+end_src

** Set up agenda file

#+begin_src emacs-lisp
(setq org-agenda-files (list
                        (concat org-files-root "agenda.org")
                        ;; Add other files here ...
                        ))
#+end_src

** Capture configuration

#+begin_src emacs-lisp
(setq org-default-notes-file (format "%sorg/notes.org" user-emacs-directory))

(setq org-capture-templates
  '(
     ("t" "Todo" entry (file+headline (concat org-files-root "agenda.org") "Tasks")
        "* TODO %?\n  %U\n  %i\n  %a\n")
     ("j" "Journal" entry (file+datetree (concat org-files-root "notes.org"))
        "* %?\nEntered on %U\n  %i\n  %a\n")
     ("w" "Webplace" entry (file (concat org-files-root "webplaces.org"))
        "* %^L\n%^g\n")
   ))
#+end_src

** Strike done tasks

#+begin_src emacs-lisp
(setq org-fontify-done-headline t)
(custom-set-faces
 '(org-done ((t (:foreground "PaleGreen"
                             :weight normal
                             :strike-through t))))
 '(org-headline-done
   ((((class color) (min-colors 16) (background dark))
     (:foreground "Grey55" :strike-through t)))))
#+end_src

** Source code syntax highlighting

#+begin_src emacs-lisp
(setq org-src-fontify-natively t)
#+end_src

** Publish webplaces when saving webplaces.org file

#+begin_src emacs-lisp
(defun pl/org-mode-publish-webplaces()
  (interactive)
  (message "Org mode publish webplaces hook")
  (when (string-match "webplaces\\.org" buffer-file-name)
    (condition-case nil
        (progn
          (let ((buffer-file-name-html (replace-regexp-in-string "\\.org$" ".html" buffer-file-name)))
            (org-export-as-html 3)
            (shell-command (format "scp -P 38170 %s pierre@qsdfgh.com:/home/www/www/" buffer-file-name-html))
            (delete-file buffer-file-name-html)))
      (error "Error while exporting and publishing webplaces.org"))))


(add-hook 'org-mode-hook
          (lambda ()
            (add-hook 'after-save-hook 'pl/org-mode-publish-webplaces nil 'make-it-local)))
#+end_src

* Ido mode

** General mode

#+begin_src emacs-lisp
(require 'ido)
(ido-mode t)
(setq ido-enable-flex-matching t)
#+end_src

** Vertical mode

#+begin_src emacs-lisp
(require 'ido-vertical-mode)
(ido-vertical-mode)
#+end_src

** Hacks

#+begin_src emacs-lisp
(require 'ido-hacks)
(ido-hacks-mode)
#+end_src

* Autopair mode

#+begin_src emacs-lisp
(autopair-global-mode t)
#+end_src

* Auto-complete-mode

#+begin_src emacs-lisp
(require 'auto-complete)
(global-auto-complete-mode t)
(require 'auto-complete-config)
(ac-config-default)
(setq-default ac-sources
              '(
                ac-source-abbrev
                ac-source-dictionary
                ac-source-filename
                ac-source-files-in-current-dir
                ac-source-functions
                ac-source-variables
                ac-source-symbols
                ac-source-features
                ac-source-words-in-all-buffer
                ac-source-words-in-same-mode-buffers))
#+end_src

* Recentf mode

#+begin_src emacs-lisp
(require 'recentf)
(recentf-mode 1)
(setq recentf-max-menu-items 25)
#+end_src

* Rainbow mode

Only when CSS file is loaded

#+begin_src emacs-lisp
(add-hook 'css-mode-hook
          (lambda () (rainbow-mode 1)))
#+end_src

* Flycheck mode

#+begin_src emacs-lisp
(require 'flycheck)
#+end_src

* Idle Highlight mode

Highlight a word-at-point after a delay

#+begin_src emacs-lisp
(defun my-coding-hook ()
  (idle-highlight-mode t))

(add-hook 'emacs-lisp-mode-hook 'my-coding-hook)
(add-hook 'ruby-mode-hook 'my-coding-hook)
(add-hook 'js2-mode-hook 'my-coding-hook)
(add-hook 'php-mode-hook 'my-coding-hook)
#+end_src

* ElFeed

Setup feeds

#+begin_src emacs-lisp
(setq elfeed-feeds
      '(("http://planet.emacsen.org/atom.xml" emacs)
        ("http://emacsredux.com/atom.xml" emacs dev blog)
        ("http://nullprogram.com/feed/" emacs blog)
        ("http://www.masteringemacs.org/feed/" emacs dev blog)
        ("http://sachachua.com/blog/feed/" emacs blog)
        ("http://batsov.com/atom.xml" ruby emacs dev blog)
        ("http://www.securityfocus.com/rss/vulnerabilities.xml" security)
        ("http://planet.debian.org/rss20.xml" system linux debian)
        ("http://www.reddit.com/r/debian.rss" system linux debian)
        ("http://www.reddit.com/r/emacs.rss" emacs)
        ("http://www.reddit.com/r/netsec.rss" security)
        ("https://www.schneier.com/blog/atom.xml" security blog)
        ("http://www.reddit.com/r/linux.rss" system linux)
        ("http://www.reddit.com/r/ruby.rss" ruby dev)
        ("https://www.ruby-lang.org/en/feeds/news.rss" ruby dev)
        ("http://devblog.avdi.org/feed/" ruby dev blog)
        ("http://feeds.feedburner.com/codinghorror?format=xml" dev blog)
        "http://xkcd.com/rss.xml"))
#+end_src
