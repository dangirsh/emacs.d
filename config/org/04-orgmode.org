* Org mode specific configuration

Set org files root

#+begin_src emacs-lisp
(setq org-files-root (format "%sorg/" user-emacs-directory))
(unless (file-accessible-directory-p org-files-root)
  (make-directory org-files-root))
#+end_src

Set up agenda file

#+begin_src emacs-lisp
(setq org-agenda-files (list
                        (concat org-files-root "agenda.org")
                        ;; Add other files here ...
                        ))
#+end_src

Capture configuration

#+begin_src emacs-lisp
(setq org-default-notes-file (format "%sorg/notes.org" user-emacs-directory))

(setq org-capture-templates
  '(
     ("t" "Todo" entry (file+headline (concat org-files-root "agenda.org") "Tasks")
        "* TODO %?\n  %U\n  %i\n  %a\n")
     ("j" "Journal" entry (file+datetree (concat org-files-root "notes.org"))
        "* %?\nEntered on %U\n  %i\n  %a\n")
     ("w" "Webplace" entry (file (concat org-files-root "webplaces.org"))
        "* %^L %^g\n")
   ))
#+end_src

Strike done tasks (from Sacha's config)

#+begin_src emacs-lisp
(setq org-fontify-done-headline t)
(custom-set-faces
 '(org-done ((t (:foreground "PaleGreen"
                             :weight normal
                             :strike-through t))))
 '(org-headline-done
   ((((class color) (min-colors 16) (background dark))
     (:foreground "Grey55" :strike-through t)))))
#+end_src

Source code syntax highlighting

#+begin_src emacs-lisp
(setq org-src-fontify-natively t)
#+end_src

Hack to avoid `org-html-fontify-code' errors (credits: http://wenshanren.org/?p=781)

#+begin_src emacs-lisp
(defun org-font-lock-ensure ()
  (font-lock-fontify-buffer))
#+end_src

Org publishing projects

#+begin_src emacs-lisp

(setq org-publish-src-dir "~/.emacs.d/org/qsdfgh.com/")
(setq org-publish-src-dir-assets (concat org-publish-src-dir "assets/"))
(setq org-publish-src-dir-webplaces "~/.emacs.d/org/")

(setq org-publish-dest-dir "/ssh:pierre@qsdfgh.com#38170:/home/www/www/")
(setq org-publish-dest-dir-assets (concat org-publish-dest-dir "assets/"))

(setq html-chunk-head "
<link href=\"http://fonts.googleapis.com/css?family=Oswald\" rel=\"stylesheet\" type=\"text/css\" />
<link href=\"/assets/style.css\" rel=\"stylesheet\" type=\"text/css\" />
<link rel=\"alternate\" type=\"application/rss+xml\" href=\"/rss.xml\" title=\"RSS feed for qsdfgh.com\" />
")

(setq html-chunk-head-bookmarks "
<link href=\"http://fonts.googleapis.com/css?family=Oswald\" rel=\"stylesheet\" type=\"text/css\" />
<link href=\"/assets/style.css\" rel=\"stylesheet\" type=\"text/css\" />
<link href=\"/assets/webplaces.css\" rel=\"stylesheet\" type=\"text/css\" />
<script type=\"text/javascript\" src=\"//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js\"></script>
<script type=\"text/javascript\" src=\"/assets/webplaces.js\"></script>
<link rel=\"alternate\" type=\"application/rss+xml\" href=\"/rss.xml\" title=\"RSS feed for qsdfgh.com\" />
")

(setq html-chunk-preamble "
<header>
<h1><a href=\"/\">Qsdfgh.com<span></span></a></h1>
<a href=\"/index.html\" class=\"single\">Home</a>
<a href=\"/about.html\" class=\"single\">About</a>
<ul class=\"contact\">
<li><a href=\"https://twitter.com/pierre404\" class=\"twitter\" title=\"Twitter\" target=\"_blank\">Twitter</a></li>
<li><a href=\"https://github.com/pierre-lecocq\" class=\"github\" title=\"Github\" target=\"_blank\">Github</a></li>
<li><a href=\"https://rubygems.org/profiles/pierre404\" class=\"rubygems\" title=\"Rubygems\" target=\"_blank\">Rubygems</a></li>
<li><a href=\"http://fr.linkedin.com/in/pierrelecocqlinkedin\" class=\"linkedin\" title=\"Linkedin\" target=\"_blank\">Linkedin</a></li>
<li><a href=\"/rss.xml\" class=\"rss\" title=\"RSS\" target=\"_blank\">RSS</a></li>
<li><a href=\"mailto:pierre.lecocq@gmail.com?subject=Contact+from+qsdfgh.com\" class=\"email\" title=\"Email\" target=\"_blank\">Email</a></li>
</ul>
</header>")

(setq html-chunk-postamble "
<footer>
<a href=\"/\">Home</a>
 | <a href=\"/about.html\">About</a>
 | <a href=\"/webplaces.html\">Bookmarks</a>
 | <a href=\"https://github.com/pierre-lecocq/qsdfgh.com/commits/master\" target=\"_blank\">What's new ?</a>
 | Generated with <a href=\"http://orgmode.org\">OrgMode</a> under <a rel=\"license\" href=\"http://creativecommons.org/licenses/by-sa/3.0/deed.en_US\">Creative Commons License</a>
 <form action=\"https://www.paypal.com/cgi-bin/webscr\" method=\"post\" target=\"_top\"><input type=\"hidden\" name=\"cmd\" value=\"_s-xclick\"><input type=\"hidden\" name=\"hosted_button_id\" value=\"5DVQSZALUACTY\"><input type=\"image\" src=\"/assets/donate.png\" border=\"0\" name=\"submit\" alt=\"\"><img alt=\"\" border=\"0\" src=\"https://www.paypalobjects.com/fr_FR/i/scr/pixel.gif\" width=\"1\" height=\"1\"></form>
</footer>
<div class=\"my-screen\"></div>")

;; Invoke with `org-publish'
(setq org-publish-project-alist
  `(
    ("webplaces-org"
     :with-author "Pierre Lecocq"
     :with-email "pierre.lecocq@gmail.com"
     :base-directory ,org-publish-src-dir-webplaces
     :include ("webplaces.org")
     :exclude "agenda.org|notes.org"
     :exclude-tags ("noexport" "todo")
     :recursive nil
     :publishing-directory ,org-publish-dest-dir
     :publishing-function (org-html-publish-to-html)
     :html-extension "html"
     :base-extension "org"
     :language "en"
     :with-toc nil
     :section-numbers nil
     :html-doctype "html5"
     :html-head-include-default-style nil
     :html-head-include-scripts nil
     :html-head ,html-chunk-head-bookmarks
     :html-preamble ,html-chunk-preamble
     :html-postamble ,html-chunk-postamble
     :htmlized-source t)

    ("qsdfgh-org"
     :with-author "Pierre Lecocq"
     :with-email "pierre.lecocq@gmail.com"
     :base-directory ,org-publish-src-dir
     :publishing-directory ,org-publish-dest-dir
     :publishing-function (org-html-publish-to-html)
     :html-extension "html"
     :base-extension "org"
     :recursive t
     :language "en"
     :exclude-tags ("noexport" "todo")
     :section-numbers nil
     :with-toc nil
     :org-src-fontify-natively t
     :org-export-htmlize-output-type 'css
     :html-doctype "html5"
     :html-head-include-default-style nil
     :html-head-include-scripts nil
     :html-head ,html-chunk-head
     :html-preamble ,html-chunk-preamble
     :html-postamble ,html-chunk-postamble
     :htmlized-source t)

    ("qsdfgh-assets"
     :base-directory ,org-publish-src-dir-assets
     :publishing-directory ,org-publish-dest-dir-assets
     :base-extension "css\\|js\\|png\\|jpg\\|gif\\|pdf"
     :recursive t
     :publishing-function org-publish-attachment)

    ("qsdfgh" :components ("qsdfgh-org" "qsdfgh-assets"))
    ("webplaces" :components ("webplaces-org" "qsdfgh-assets"))
))
#+end_src
